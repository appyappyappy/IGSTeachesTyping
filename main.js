var textSnippets = {
     "obama": [
          "Almost a decade has passed since this book was first published.",
          "As I mention in the original introduction, the opportunity to write the book came while I was in law school, the result of my election as the first African-American president of the Harvard Law Review.",
          "In the wake of some modest publicity, I received an advance from a publisher and went to work with the belief that the story of my family, and my efforts to understand that story, might speak in some way to the fissures of race that have characterized the American experience, as well as the fluid state of identity -- the leaps through time, the collision of cultures -- that mark our modern life.",
          "Like most first-time authors, I was filled with hope and despair upon the book's publication -- hope that the book might succeed beyond my youthful dreams, despair that I had failed to say anything worth saying. The reality fell somewhere in between.",
          "The reviews were mildly favorable. People actually showed up at the readings my publisher arranged.",
          "The sales were underwhelming. And, after a few months, I went on with the business of my life, certain that my career as an author would be short-lived, but glad to have survived the process with my dignity more or less intact.",
          "I had little time for reflection over the next ten years. I ran a voter registration project in the 1992 election cycle, began a civil rights practice, and started teaching constitutional law at the University of Chicago. My wife and I bought a house, were blessed with two gorgeous, healthy, and mischievous daughters, and struggled to pay the bills.",
          "When a seat in the state legislature opened up in 1996, some friends persuaded me to run for the office, and I won.",
          "I had been warned, before taking office, that state politics lacks the glamour of its Washington counterpart; one labors largely in obscurity, mostly on topics that mean a great deal to some but that the average man or woman on the street can safely ignore (the regulation of mobile homes, say, or the tax consequences of farm equipment depreciation).",
          "Nonetheless, I found the work satisfying, mostly because the scale of state politics allows for concrete results -- an expansion of health insurance for poor children, or a reform of laws that send innocent men to death row -- within a meaningful time frame.", 
          "And too, because within the capitol building of a big, industrial state, one sees every day the face of a nation in constant conversation: inner-city mothers and corn and bean farmers, immigrant day laborers alongside suburban investment bankers -- all jostling to be heard, all ready to tell their stories.",
          "A few months ago, I won the Democratic nomination for a seat as the U.S. senator from Illinois. It was a difficult race, in a crowded field of well-funded, skilled, and prominent candidates; without organizational backing or personal wealth, a black man with a funny name, I was considered a long shot.", 
          "And so, when I won a majority of the votes in the Democratic primary, winning in white areas as well as black, in the suburbs as well as Chicago, the reaction that followed echoed the response to my election to the Law Review.",
          "Mainstream commentators expressed surprise and genuine hope that my victory signaled a broader change in our racial politics.",
          "Within the black community, there was a sense of pride regarding my accomplishment, a pride mingled with frustration that fifty years after Brown v. Board of Education and forty years after the passage of the Voting Rights Act, we should still be celebrating the possibility (and only the possibility, for I have a tough general election coming up) that I might be the sole African American -- and only the third since Reconstruction -- to serve in the Senate.",
          "My family, friends, and I were mildly bewildered by the attention, and constantly aware of the gulf between the hard sheen of media reports and the messy, mundane realities of life as it is truly lived.",
          "Just as that spate of publicity prompted my publisher's interest a decade ago, so has this fresh round of news clippings encouraged the book's re-publication.",  
          "For the first time in many years, I've pulled out a copy and read a few chapters to see how much my voice may have changed over time.",
          "I confess to wincing every so often at a poorly chosen word, a mangled sentence, an expression of emotion that seems indulgent or overly practiced.", 
          "I have the urge to cut the book by fifty pages or so, possessed as I am with a keener appreciation for brevity.", 
          "I cannot honestly say, however, that the voice in this book is not mine -- that I would tell the story much differently today than I did ten years ago, even if certain passages have proven to be inconvenient politically, the grist for pundit commentary and opposition research.",
          "What has changed, of course, dramatically, decisively, is the context in which the book might now be read.", 
          "I began writing against a backdrop of Silicon Valley and a booming stock market; the collapse of the Berlin Wall; Mandela -- in slow, sturdy steps -- emerging from prison to lead a country; the signing of peace accords in Oslo.", 
          "Internationally, writers announced the end of history, the ascendance of free markets and liberal democracy, the replacement of old hatreds and wars between nations with virtual communities and battles for market share."
     ],
     "gameOfThrones": [
          "The first season of Game of Thrones premiered on HBO on April 17, 2011, and concluded on June 22, 2011. It was the first season of the fantasy drama series, and the first season of the HBO fantasy drama series. The series is based on A Song of Ice and Fire, the first novel of the fantasy novels series by American author George R. R. Martin.",
          "When I was a girl, my father held a ball. I'm his only living child, so he wanted to make a good match for me. He invited dozens of young lords to Tarth. I didn't want to go, but he dragged me to the ballroom. And it was wonderful. None of the boys noticed how mulish and tall I was.",
          "In the Kingswood lived a mother and her cub. She loved him very much, but there were other things that lived in the woods. Evil things. Like stags. And wolves. They could hear them crying in the night, and the cub was frightened.",
          "His mother said, you are a lion, my son. You mustn't be afraid, for one day all the beasts will bow to you. You will be king. All the stags will bow, all the wolves will bow, the bears in the north and the foxes of the south, all the birds in the sky and the beasts in the sea.",
          "There it is. That's the look. I've seen it for 17 years on face after face. You all despise me. Kingslayer. Oath breaker. Man without honor. You've heard of wildfire? Of course. The mad king was obsessed with it. He loved to watch people burn--the way their skin blackened, blistered, melted off their bones.",
          "Brothers! A hundred generations have defended this castle! It's never fallen before, she will not fall tonight! Those are Thenns at our walls! They eat the flesh of the men they kill! Do you want to fill the belly of a Thenn, tonight? Tonight, we fight!",
          "We die today, brothers! We die bleeding from a hundred wounds, with arrows in our necks and spears in our guts! But our war cries will echo through eternity. They will sing about the Battle of Winterfell until the Iron Islands have slipped beneath the waves. Every man, woman, and child will know who we were and how long we stood!"
     ],
     "rickRoll": [
          "We're no strangers to love. You know the rules and so do I. A full commitment's what I'm thinking of. You wouldn't get this from any other guy.",
          "Never gonna give you up, never gonna let you down, never gonna run around and desert you. Never gonna make you cry, never gonna say goodbye. Never gonna tell a lie and hurt you.",
          "Never gonna give you up, never gonna let you down, never gonna run around and desert you. Never gonna make you cry, never gonna say goodbye. Never gonna tell a lie and hurt you.",
          "We've known each other for so long. Your heart's been aching, but you're too shy to say it. Inside, we both know what's been going on. We know the game, and we're gonna play it.",
          "Richard Paul Astley (born 6 February 1966) is an English singer, songwriter and radio personality, who has been active in music for several decades. He gained worldwide fame in the 1980s, having multiple hits including his signature song 'Never Gonna Give You Up', 'Together Forever' and 'Whenever You Need Somebody', and returned to music full-time in the 2000s after a 6-year hiatus."
     ],
     "beeMovie": [ 
          "According to all known laws of aviation, there is no way a bee should be able to fly. Its wings are too small to get its fat little body off the ground. The bee, of course, flies anyway because bees don't care what humans think is impossible."],
     "shrekMovie": [ 
          "In the swamp of despair, there lived a most ghastly creature, whose name was Shrek. He had no idea what he was doing. But somehow, he got his hands on a huge log, and he was never afraid to use it.",
          "This'll be fun. We'll stay up late, swapping manly stories, and in the morningâ€¦ I'm making waffles!",
          "Don't you want to tell me about your trip? How about a game of Parcheesi?",
          "Oh, Shrek. Don't worry, things just seem bad because it's dark and rainy and Fiona's father hired a sleazy hitman to whack you. It'll be better in the morning. You'll see.",
          "Well my stomach aches and my palms just got sweaty, must be a high school.",
          "You know what the best part of today was? I got the chance to fall in love with you all over again."
     ],
     "abrahamLincon": [
          "America will never be destroyed from the outside. If we falter and lose our freedoms, it will be because we destroyed ourselves.",
          "I have been driven many times upon my knees by the overwhelming conviction that I had no where else to go. My own wisdom and that of all about me seemed insufficient for that day.",
          "We are not enemies, but friends. We must not be enemies. Though passion may have strained, it must not break our bonds of affection. The mystic chords of memory will swell when again touched, as surely they will be, by the better angels of our nature.",
          "Four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition that all men are created equal.",
          "Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can long endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this.",
          "But, in a larger sense, we can not dedicate we can not consecrate we can not hallow, this ground The brave men, living and dead, who struggled here, have hallowed it, far above our poor power to add or detract. The world will little note, nor long remember what we say here; while it can never forget what they did here.",
          "You cannot escape the responsibility of tomorrow by evading it today.",
          "You can fool all the people some of the time, and some of the people all the time, but you cannot fool all the people all the time.",
          "I have not failed. I've just found 10,000 ways that won't work."
     ],
     "georgeWashington": [
          "If freedom of speech is taken away, then dumb and silent we may be led, like sheep to the slaughter.",
          "A primary object should be the education of our youth in the science of government. In a republic, what species of knowledge can be equally important? And what duty more pressing than communicating it to those who are to be the future guardians of the liberties of the country?"
     ],
     "johnMulaney": [
          "The more you do stuff, the better you get at dealing with how you still fail at it a lot of the time.",
          "I never knew you were supposed to push off of your feet when you walked. And I tried it, and I walked much faster.",
          "My childhood was completely dominated by Bill Clinton and the OJ trial. I don't think we had a family dinner where one didn't come up.",
          "I have too many influences to name. I like a wide variety of stuff, which I think has been helpful. I liked every comedian I saw on TV growing up in the '80s. Every comedian.",
          "Being president looks like the worst job in the world.",
          "My dad is and was very funny and had a really dry sense of humor, which, as a kid, seemed un-fun. But in retrospect, it's kind of hilarious.",
          "My dad came home from work and my mom told my dad that she cleaned under my bed and found a shoebox with two cigarettes and a Cosmopolitan, which prompted my dad to ask. 'How does John know how to make a Cosmopolitan?'",
          "All my money is in a savings account. My dad has explained the stock market to me maybe 75 times. I still don't understand it.",
          "I remember one time I was in bed, and my dad came in and he said 'Good night, John! Did you brush your teeth?' and I said, 'Yes', But here's the thing... I hadn't.",
          "I was always the squarest person in the cool room, and alternatively, sometimes the weirder person at the mainstream table.",
          "College was like a four-year game show called 'Do My Friends Hate Me or Do I Just Need to Go to Sleep?'",
          "In their letter, they were like, 'Hey, it's been a while since you've given us money.' I was like, 'Hey, it's been a while since you housed and taught me'"
     ],
     "kanye": [
          "JUST GOT TO LONDON!!! YOU KNOW I HAD TO PUT MY CAPS LOCK ON! I DON'T TYPE IN CAPS CAUSE I'M MAD I TYPE IN CAPS CAUSE I'M LAZY!!!",
          "I STILL THINK I AM THE GREATEST"
     ]
};
var gameOver;
var fullSentence;
var wrongSentence;
var index;
gameCode();

function gameCode(){
     //reset the game here
     document.getElementById("incorrect").innerHTML = "";
     document.getElementById("correct").innerHTML = "";
     document.getElementById("textBlurb").innerHTML = "";
     document.getElementById("auteur").innerHTML = "";
     // HELL ON EARTH
     var authorVar;
     var randomNumber = Math.floor(Math.random() * 67);
     if(randomNumber < 24){
          completedSentence = textSnippets.obama[randomNumber];
          authorVar = "- Barack Obama";
     }
     else if(randomNumber < 31){
          completedSentence = textSnippets.gameOfThrones[randomNumber-24];
          authorVar = "- George RR Martin (Game of Thrones)";
     }
     else if(randomNumber < 36){
          completedSentence = textSnippets.rickRoll[randomNumber-31];
          authorVar = "- Rick Astley";
     }
     else if(randomNumber < 37){
          completedSentence = textSnippets.beeMovie[randomNumber-36];
          authorVar = "- Jerry Seinfeld";
     }
     else if(randomNumber < 43){
          completedSentence = textSnippets.shrekMovie[randomNumber-37];
          authorVar = "- Shrek (2001)";
     }
     else if(randomNumber < 52){
          completedSentence = textSnippets.abrahamLincon[randomNumber-43];
          authorVar = "- Abraham Lincoln";
     }
     else if(randomNumber < 54){
          completedSentence = textSnippets.georgeWashington[randomNumber-52];
          authorVar = "- George Washington";
     }
     else if(randomNumber < 66){
          completedSentence = textSnippets.johnMulaney[randomNumber-54];
          authorVar = "- John Mulaney";
     }
     else if(randomNumber < 68){
          completedSentence = textSnippets.kanye[randomNumber-66];
          authorVar = "- Kayne West";
     }
     document.getElementById("textBlurb").innerHTML = completedSentence; // Assign the sentence to the second half of the HTML
     document.getElementById("auteur").innerHTML = authorVar;

     /*********************************************************************/
     /*                          REAL CODE HERE                           */
     /*********************************************************************/

     document.getElementById("text").focus();

     // Some variables (lol)
     index = 0;
     fullSentence = "", wrongSentence = "";
     var userInput = document.getElementById("text")
     userInput.value = "";
     var mistakeCounter = 0;
     var firstMistake = true;
     gameOver = false;
     document.getElementById("incorrect").innerHTML = "";
     document.getElementById("endNode").innerHTML = `Accuracy: <br>Mistakes: <br>Time: <br>Score: `

     // Timer
     var alreadyStarted = false;
     var startTime;

     // Get the input from the textbox as it comes in
     $("#text").on("input", function(){
          if(!gameOver){
          
               // The current letter is correct
               if(completedSentence.charAt(index) == userInput.value){
                    document.getElementById("incorrect").innerHTML = "";

                    // Start the timer upon the first keystroke
                    if(!alreadyStarted){
                         var d = new Date();
                         startTime = d.getTime();
                         console.log(startTime);
                         alreadyStarted = true;
                    }

                    // Add the current letter to a sentence recreating the sentence from the array
                    // Then assign this sentence to the correct portion of the HTML
                    fullSentence += userInput.value;
                    document.getElementById("correct").innerHTML = fullSentence;

                    // Clear out the textbox
                    userInput.value = ""

                    // Increment the current letter we're looking at
                    index++;
                    
                    // Slice off the first letter of the blurb you have to type
                    document.getElementById("textBlurb").innerHTML = document.getElementById("textBlurb").innerHTML.slice(1)

                    // Next mistake will be the first of the word
                    firstMistake = true;
               } 
               
               // The current phrase is incorrect
               else {

                    // Add the current letter to a sentence recording your wrong letters
                    wrongSentence += userInput.value;

                    // Update the incorrect section of the HTML
                    document.getElementById("incorrect").innerHTML = wrongSentence;

                    // Only want to count the first error, not the deletion or stackup
                    if(firstMistake){
                         mistakeCounter++;
                         firstMistake = false;
                    }
               }

               // If the section in the correct part of the HTML is the same as the starting sentence
               if(completedSentence == document.getElementById("correct").innerHTML){
                    endState(startTime, mistakeCounter, completedSentence.length);
               }
          }
          // Clear out the wrong sentence when you're done
          wrongSentence = "";
     })
}

// End of code function. Calculate 
function endState(start, mistakes, length){
     if(!gameOver){
          var d2 = new Date();

          // Get the end time and calculate the elapsed time in seconds
          var endTime = d2.getTime();
          var elapsedTime = (endTime / 1000) - (start / 1000); // elapsed = seconds

          // Calculate seconds and minutes
          var seconds = Math.floor(elapsedTime % 60);
          var minutes = Math.floor(elapsedTime/60);

          // Clip it and ship it
          var score = Math.floor(((length - mistakes) * 100) / elapsedTime);

          document.getElementById("endNode").innerHTML = `Accuracy: ${((length-mistakes)/length).toFixed(3) * 100}%<br>Mistakes: ${mistakes}<br>Time: ${elapsedTime.toFixed(2)} seconds<br>Score: ${score}`
          // alert(`It took you ${minutes} minutes and ${seconds} seconds to get this with ${mistakes} mistakes\nFinal score was ${score}`)

          gameOver = true;
     }
}